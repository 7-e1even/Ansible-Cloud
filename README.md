# Ansible Cloud - ç°ä»£åŒ–äº‘åŸç”Ÿè¿ç»´ç®¡ç†å¹³å°

[![Ansible UI](https://img.shields.io/badge/Ansible-Cloud-blue?style=for-the-badge&logo=ansible)](https://github.com/ansible/ansible)
[![Python](https://img.shields.io/badge/Python-3.11-green?style=for-the-badge&logo=python)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-Latest-teal?style=for-the-badge&logo=fastapi)](https://fastapi.tiangolo.com/)
[![React](https://img.shields.io/badge/React-19-blue?style=for-the-badge&logo=react)](https://react.dev/)
[![Docker](https://img.shields.io/badge/Docker-Supported-2496ED?style=for-the-badge&logo=docker)](https://www.docker.com/)

**Ansible Cloud** æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è¿ç»´è‡ªåŠ¨åŒ–ç®¡ç†å¹³å°ï¼Œæ·±åº¦é›†æˆ Ansible ä¸è…¾è®¯äº‘æœåŠ¡ã€‚å®ƒä¸ºè¿ç»´å›¢é˜Ÿæä¾›äº†ä¸€ç«™å¼çš„ä¸»æœºç®¡ç†ã€è‡ªåŠ¨åŒ–ä»»åŠ¡æ‰§è¡Œã€äº‘èµ„æºç¼–æ’ä»¥åŠ Web ç»ˆç«¯è®¿é—®èƒ½åŠ›ï¼Œæå¤§åœ°ç®€åŒ–äº†æ··åˆäº‘ç¯å¢ƒä¸‹çš„è¿ç»´å·¥ä½œæµã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ–¥ï¸ æ··åˆäº‘ä¸»æœºç®¡ç†

ç»Ÿä¸€çº³ç®¡æœ¬åœ°ä¸äº‘ç«¯èµ„æºï¼Œå®æ—¶æŒæ¡ä¸»æœºçŠ¶æ€ã€‚

![ä¸»æœºåˆ—è¡¨](images/hosts.png)

- **å¤šäº‘çº³ç®¡**ï¼šç»Ÿä¸€ç®¡ç†æœ¬åœ°æœåŠ¡å™¨ä¸è…¾è®¯äº‘ CVM å®ä¾‹ã€‚
- **è‡ªåŠ¨åŒæ­¥**ï¼šæ”¯æŒåå°è‡ªåŠ¨åŒæ­¥è…¾è®¯äº‘å®ä¾‹ä¿¡æ¯ï¼ˆIPã€é…ç½®ã€çŠ¶æ€ï¼‰ã€‚
- **åˆ†ç»„ç®¡ç†**ï¼šçµæ´»çš„ä¸»æœºåˆ†ç»„ä¸æ ‡ç­¾ç³»ç»Ÿã€‚

![äº‘å®ä¾‹åˆ—è¡¨](images/instances.png)

#### ä¾¿æ·è®¤è¯
æ”¯æŒ SSH å¯†ç ä¸å¯†é’¥è®¤è¯ï¼Œè‡ªåŠ¨æ¢æµ‹ SSH è¿é€šæ€§ã€‚

![å¯†é’¥è®¾ç½®](images/setkeys.png)

---

### ğŸš€ å¯è§†åŒ– Ansible ç¼–æ’

è®©è‡ªåŠ¨åŒ–è¿ç»´è§¦æ‰‹å¯åŠï¼Œæ”¯æŒä»ç®€å•çš„å‘½ä»¤æ‰§è¡Œåˆ°å¤æ‚çš„ Playbook ç¼–æ’ã€‚

![æ¨¡æ¿ç®¡ç†](images/templates.png)

- **Ad-hoc å‘½ä»¤**ï¼šWeb ç•Œé¢å¿«é€Ÿæ‰§è¡Œ Shell å‘½ä»¤ä¸ Ansible æ¨¡å—ã€‚
- **Playbook æ‰§è¡Œ**ï¼šä¸Šä¼ ã€ç¼–è¾‘å¹¶æ‰§è¡Œ Playbookï¼Œå®æ—¶æŸ¥çœ‹ä»»åŠ¡è¿›åº¦ã€‚

![ä¸€é”®éƒ¨ç½²](images/ä¸€é”®éƒ¨ç½²å¤šå°æœåŠ¡å™¨å¹¶ä¸”æ‰§è¡Œä»»åŠ¡.png)

- **æ¨¡æ¿æå–**ï¼šæ”¯æŒå°†äº‘å®ä¾‹é…ç½®æå–ä¸º Ansible æ¨¡æ¿ï¼Œå®ç°åŸºç¡€è®¾æ–½å³ä»£ç  (IaC)ã€‚

![æå–æ¨¡æ¿](images/æå–æ¨¡æ¿.png)

- **ä¸€é”®æ‰¹é‡æ­å»º**ï¼šåŸºäºæ¨¡æ¿å¿«é€Ÿæ„å»ºä¸šåŠ¡ç¯å¢ƒã€‚

![ä¸€é”®æ‰¹é‡æ­å»º](images/ä¸€é”®æ‰¹é‡æ­å»ºæ¨¡æ¿.png)

- **å®æ—¶æ—¥å¿—**ï¼šWebSocket å®æ—¶æ¨é€ä»»åŠ¡æ‰§è¡Œæ—¥å¿—ï¼Œç»“æœä¸€ç›®äº†ç„¶ã€‚

---

### â˜ï¸ è…¾è®¯äº‘æ·±åº¦é›†æˆ

æ— ç¼å¯¹æ¥è…¾è®¯äº‘ APIï¼Œåœ¨å•ä¸€æ§åˆ¶å°ä¸­ç®¡ç†äº‘èµ„æºç”Ÿå‘½å‘¨æœŸã€‚

![åˆ›å»ºå®ä¾‹](images/create.png)

- **èµ„æºç®¡ç†**ï¼šæŸ¥çœ‹è´¦æˆ·ä½™é¢ã€åœ°åŸŸ/å¯ç”¨åŒºåˆ†å¸ƒã€å®ä¾‹è§„æ ¼ä¸é•œåƒä¿¡æ¯ã€‚
- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šæ”¯æŒå®ä¾‹çš„åˆ›å»ºã€å¼€æœºã€å…³æœºã€é‡å¯ã€é‡ç½®å¯†ç åŠé”€æ¯/é€€è¿˜ã€‚
- **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒæ‰¹é‡é”€æ¯äº‘å®ä¾‹ï¼Œé‡Šæ”¾é—²ç½®èµ„æºã€‚

---

### ğŸ’» Web ç»ˆç«¯ (WebSSH)

éšæ—¶éšåœ°è®¿é—®æ‚¨çš„æœåŠ¡å™¨ï¼Œæ— éœ€å®‰è£…ä»»ä½•å®¢æˆ·ç«¯ã€‚

![Webç»ˆç«¯](images/terminal.png)

- **æ— éœ€æ’ä»¶**ï¼šåŸºäº WebSocket + xterm.js çš„çº¯ Web ç»ˆç«¯ã€‚
- **å¤šä¼šè¯æ”¯æŒ**ï¼šåŒæ—¶ç®¡ç†å¤šä¸ª SSH ä¼šè¯ã€‚
- **æ–‡ä»¶ä¼ è¾“**ï¼šæ”¯æŒ SFTP æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½ã€‚

---

### ğŸ›¡ï¸ å®‰å…¨ä¸å®¡è®¡

- **æ“ä½œå®¡è®¡**ï¼šè®°å½•å…³é”®æ“ä½œæ—¥å¿—ä¸å‘½ä»¤æ‰§è¡Œå†å²ã€‚
- **JWT è®¤è¯**ï¼šå®‰å…¨çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯ (Backend)
- **æ¡†æ¶**: FastAPI (Python 3.11)
- **ä»»åŠ¡é˜Ÿåˆ—**: BackgroundTasks (FastAPI Native)
- **æ•°æ®åº“**: SQLite (è½»é‡çº§ï¼Œæ— éœ€é¢å¤–éƒ¨ç½²)
- **æ ¸å¿ƒç»„ä»¶**:
  - `Ansible Runner`: æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡
  - `Paramiko`: å¤„ç† SSH è¿æ¥ä¸å¯†é’¥
  - `TencentCloud SDK`: å¯¹æ¥è…¾è®¯äº‘ API

### å‰ç«¯ (Frontend)
- **æ¡†æ¶**: React 19 + UmiJS Max
- **UI ç»„ä»¶åº“**: Ant Design Pro 6
- **ç»ˆç«¯ç»„ä»¶**: xterm.js
- **æ•°æ®è¯·æ±‚**: Axios + React Hooks

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ Docker Compose (æ¨è)

è¿™æ˜¯æœ€å¿«é€Ÿçš„éƒ¨ç½²æ–¹å¼ï¼Œé€‚åˆæµ‹è¯•ä¸ç”Ÿäº§ç¯å¢ƒã€‚

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/yourusername/ansible-cloud.git
   cd ansible-cloud
   ```

2. **é…ç½®æ–‡ä»¶**
   ç¡®ä¿æ ¹ç›®å½•ä¸‹å­˜åœ¨ `config.yaml` æ–‡ä»¶ï¼ˆå¯å‚è€ƒä»“åº“ä¸­çš„ç¤ºä¾‹ï¼‰ã€‚
   ```bash
   # ç¤ºä¾‹ config.yaml
   admin:
     username: admin
     password: admin123
   enable_login: true
   ```

3. **å¯åŠ¨æœåŠ¡**
   ```bash
   docker-compose up -d
   ```

4. **è®¿é—®ç³»ç»Ÿ**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`
   - é»˜è®¤è´¦å·: `admin`
   - é»˜è®¤å¯†ç : `admin123`

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘éƒ¨ç½²

#### åç«¯ç¯å¢ƒ

1. **Python ç¯å¢ƒå‡†å¤‡**
   å»ºè®®ä½¿ç”¨ Python 3.11+
   ```bash
   cd ansible-cloud
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```
   *æ³¨æ„ï¼šWindows ç¯å¢ƒä¸‹ä¸æ”¯æŒåŸç”Ÿ Ansibleï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™ã€‚*

3. **å¯åŠ¨åç«¯**
   ```bash
   uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
   ```

#### å‰ç«¯ç¯å¢ƒ

1. **Node.js ç¯å¢ƒå‡†å¤‡**
   éœ€è¦ Node.js 20+ åŠ pnpmã€‚

2. **å®‰è£…ä¾èµ–**
   ```bash
   cd myapp
   pnpm install
   ```

3. **å¯åŠ¨å‰ç«¯**
   ```bash
   pnpm dev
   ```
   å‰ç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:8000` (å¼€å‘æ¨¡å¼ä¸‹é€šå¸¸ä¼šæœ‰åå‘ä»£ç†é…ç½®æŒ‡å‘åç«¯)ã€‚

## âš™ï¸ é…ç½®è¯´æ˜

ç³»ç»Ÿä¸»è¦é…ç½®æ–‡ä»¶ä¸º `config.yaml`ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|---|---|---|
| `admin.username` | ç®¡ç†å‘˜ç”¨æˆ·å | admin |
| `admin.password` | ç®¡ç†å‘˜å¯†ç  | admin123 |
| `enable_login` | æ˜¯å¦å¼€å¯ç™»å½•éªŒè¯ | true |

*æ³¨æ„ï¼šè…¾è®¯äº‘ AK/SK è¯·åœ¨ç³»ç»Ÿç™»å½•åçš„â€œç³»ç»Ÿè®¾ç½®â€é¡µé¢è¿›è¡Œé…ç½®ï¼Œä¸éœ€è¦å†™å…¥é…ç½®æ–‡ä»¶ã€‚*

## ğŸ“ ç›®å½•ç»“æ„

```
.
â”œâ”€â”€ app/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/             # API è·¯ç”±
â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒé…ç½®ä¸æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ models/          # Pydantic æ¨¡å‹
â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘å±‚ (Ansible, Tencent Cloud, etc.)
â”‚   â””â”€â”€ main.py          # ç¨‹åºå…¥å£
â”œâ”€â”€ myapp/               # å‰ç«¯ä»£ç  (UmiJS)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ pages/       # é¡µé¢ç»„ä»¶
â”‚   â”‚   â””â”€â”€ services/    # å‰ç«¯ API å®šä¹‰
â”‚   â””â”€â”€ config/          # Umi é…ç½®
â”œâ”€â”€ db/                  # SQLite æ•°æ®åº“æ–‡ä»¶ (è¿è¡Œæ—¶ç”Ÿæˆ)
â”œâ”€â”€ logs/                # ç³»ç»Ÿæ—¥å¿— (è¿è¡Œæ—¶ç”Ÿæˆ)
â”œâ”€â”€ docker-compose.yaml  # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ Dockerfile           # Docker æ„å»ºæ–‡ä»¶
â””â”€â”€ config.yaml          # ç³»ç»Ÿé…ç½®æ–‡ä»¶
```

## ğŸ“„ License

[MIT License](LICENSE)
